*---------------------------------------------------------------------*
* PF-STATUS determination (Maintplan-style)
*---------------------------------------------------------------------*
FORM set_pfstatus_from_state.

  DATA lv_pf TYPE sypfkey.

  " Decide which PF-STATUS to use
  IF gv_show_char = gc_false AND gv_show_ltxt = gc_false.
    lv_pf = 'ZSALV_BOTH_HIDE'.
  ELSEIF gv_show_char = gc_false AND gv_show_ltxt = gc_true.
    lv_pf = 'ZSALV_LTXT_SHOW'.
  ELSE.
    " Characteristics mode (with or without long text)
    lv_pf = 'ZSALV_CLIST_SHOW'.
  ENDIF.

  " Apply to SALV
  IF lo_alv IS BOUND.
    lo_alv->set_screen_status(
      pfstatus = lv_pf
      report   = sy-repid ).
      " no SET_FUNCTIONS here â€“ avoids the type error
  ENDIF.

ENDFORM.