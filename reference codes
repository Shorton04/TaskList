DATA: lv_tolun_p TYPE p LENGTH 16 DECIMALS 9,
      lv_tolob_p TYPE p LENGTH 16 DECIMALS 9.

IF so_tolun[] IS NOT INITIAL.
  TRY.
      lv_tolun_p = so_tolun-low.     "char → packed
    CATCH cx_sy_conversion_no_number.
      MESSAGE 'Invalid lower spec value' TYPE 'E'.
  ENDTRY.

  IF gs_base-toleranzun < lv_tolun_p.
    CONTINUE.
  ENDIF.
ENDIF.


IF so_tolob[] IS NOT INITIAL.
  TRY.
      lv_tolob_p = so_tolob-low.
    CATCH cx_sy_conversion_no_number.
      MESSAGE 'Invalid upper spec value' TYPE 'E'.
  ENDTRY.

  IF gs_base-toleranzob > lv_tolob_p.
    CONTINUE.
  ENDIF.
ENDIF.


"--- Format Upper / Lower Spec for ALV (FLTP → CHAR)
DATA: lv_tolun_p  TYPE p LENGTH 16 DECIMALS 9,
      lv_tolob_p  TYPE p LENGTH 16 DECIMALS 9,
      lv_tolun_txt TYPE c LENGTH 20,
      lv_tolob_txt TYPE c LENGTH 20.

CLEAR: lv_tolun_p, lv_tolob_p, lv_tolun_txt, lv_tolob_txt.

"--- Lower Spec Limit
IF ls_base-toleranzun IS NOT INITIAL.
  lv_tolun_p = ls_base-toleranzun.              
  WRITE lv_tolun_p TO lv_tolun_txt DECIMALS 9.  

  REPLACE ALL OCCURRENCES OF ',' IN lv_tolun_txt WITH '.'.
  ls_disp-toleranzun = lv_tolun_txt.
ENDIF.

"--- Upper Spec Limit
IF ls_base-toleranzob IS NOT INITIAL.
  lv_tolob_p = ls_base-toleranzob.              
  WRITE lv_tolob_p TO lv_tolob_txt DECIMALS 9.  

  REPLACE ALL OCCURRENCES OF ',' IN lv_tolob_txt WITH '.'.
  ls_disp-toleranzob = lv_tolob_txt.
ENDIF.