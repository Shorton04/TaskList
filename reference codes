ELSE.

  "Reassign data AFTER internal table was rebuilt in PAI or event
  DATA(lo_model) = lo_alv->get_model( ).
  lo_model->set_data( REF #( gt_display ) ).

  "Apply column visibility AFTER assigning data
  PERFORM set_column_visibility_by_state.

  lo_alv->refresh( ).

ENDIF.