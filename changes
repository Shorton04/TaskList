  "-----------------------------------------------------------*
  " Remove duplicate header rows (O/C), keep all long-text rows (L)
  "-----------------------------------------------------------*
  DATA: lt_header TYPE STANDARD TABLE OF ty_task_disp,
        lt_ltxt   TYPE STANDARD TABLE OF ty_task_disp.

  CLEAR: lt_header, lt_ltxt.

  LOOP AT gt_display INTO gs_display.
    IF gs_display-row_kind = 'L'.
      APPEND gs_display TO lt_ltxt.     " keep ALL long-text lines
    ELSE.
      APPEND gs_display TO lt_header.   " header rows (O or C)
    ENDIF.
  ENDLOOP.

  " One header per key: Group/Cntr/Plant/Op/Insp#
  SORT lt_header BY plnty plnnr plnal vornr merknr row_kind.
  DELETE ADJACENT DUPLICATES FROM lt_header
    COMPARING plnty plnnr plnal vornr merknr row_kind.

  " Rebuild GT_DISPLAY: first headers, then LT rows
  CLEAR gt_display.
  APPEND LINES OF lt_header TO gt_display.
  APPEND LINES OF lt_ltxt   TO gt_display.




