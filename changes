"===============================================================
" Column whitelist â€“ only these should stay visible
"===============================================================
DATA: lt_keep TYPE STANDARD TABLE OF lvc_fname,
      lv_name TYPE lvc_fname.

APPEND 'PLNNR'      TO lt_keep.
APPEND 'PLNAL'      TO lt_keep.
APPEND 'WERKS'      TO lt_keep.
APPEND 'VORNR'      TO lt_keep.
APPEND 'TDFORMAT'   TO lt_keep.
APPEND 'OP_LTXT'    TO lt_keep.
APPEND 'ARBPL_O'    TO lt_keep.
APPEND 'ARBEI'      TO lt_keep.
APPEND 'KURZT_CHAR' TO lt_keep.
APPEND 'PMETHODE'   TO lt_keep.
APPEND 'CHAR_LTXT'  TO lt_keep.

"===============================================================
" Hide all columns except whitelist
"===============================================================
DATA lt_cols TYPE salv_t_column_ref.
DATA lo_col  TYPE REF TO cl_salv_column_table.

lt_cols = lo_columns->get( ).

LOOP AT lt_cols INTO lo_col.
  lv_name = lo_col->get_columnname( ).

  READ TABLE lt_keep WITH KEY table_line = lv_name TRANSPORTING NO FIELDS.
  IF sy-subrc <> 0.
    lo_col->set_technical( abap_true ).
  ENDIF.
ENDLOOP.

"===============================================================
" Set column captions (STRING templates)
"===============================================================
TRY.
    lo_column ?= lo_columns->get_column( 'PLNNR' ).
    lo_column->set_short_text(  |Group| ).
    lo_column->set_medium_text( |Group| ).
    lo_column->set_long_text(   |Group| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'PLNAL' ).
    lo_column->set_short_text(  |Counter| ).
    lo_column->set_medium_text( |Counter| ).
    lo_column->set_long_text(   |Counter| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'WERKS' ).
    lo_column->set_short_text(  |Plant| ).
    lo_column->set_medium_text( |Plant| ).
    lo_column->set_long_text(   |Plant| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'VORNR' ).
    lo_column->set_short_text(  |Operation| ).
    lo_column->set_medium_text( |Operation| ).
    lo_column->set_long_text(   |Operation| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'TDFORMAT' ).
    lo_column->set_short_text(  |Fmt Key| ).
    lo_column->set_medium_text( |Format Key| ).
    lo_column->set_long_text(   |Format Key| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'OP_LTXT' ).
    lo_column->set_short_text(  |Op Long Text| ).
    lo_column->set_medium_text( |Operation Long Text| ).
    lo_column->set_long_text(   |Operation Long Text| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'ARBPL_O' ).
    lo_column->set_short_text(  |Work Ctr| ).
    lo_column->set_medium_text( |Work Center| ).
    lo_column->set_long_text(   |Work Center| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'ARBEI' ).
    lo_column->set_short_text(  |Work| ).
    lo_column->set_medium_text( |Work| ).
    lo_column->set_long_text(   |Work| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'KURZT_CHAR' ).
    lo_column->set_short_text(  |Insp. Desc.| ).
    lo_column->set_medium_text( |Insp. Description| ).
    lo_column->set_long_text(   |Inspection Description| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'PMETHODE' ).
    lo_column->set_short_text(  |Insp. Meth.| ).
    lo_column->set_medium_text( |Inspection Method| ).
    lo_column->set_long_text(   |Inspection Method| ).
  CATCH cx_salv_not_found.
ENDTRY.

TRY.
    lo_column ?= lo_columns->get_column( 'CHAR_LTXT' ).
    lo_column->set_short_text(  |Char Long Text| ).
    lo_column->set_medium_text( |Characteristic Long Text| ).
    lo_column->set_long_text(   |Characteristic Long Text| ).
  CATCH cx_salv_not_found.
ENDTRY.